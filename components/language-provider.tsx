"use client"

import type React from "react"
import { createContext, useContext, useState, useEffect } from "react"

type Language = "ar" | "en"

interface LanguageContextType {
  language: Language
  setLanguage: (lang: Language) => void
  t: (key: string) => string
  dir: "rtl" | "ltr"
  isLoaded: boolean
}

const translations = {
  ar: {
    // Auth
    login: "تسجيل الدخول",
    "login.title": "تسجيل الدخول إلى حسابك",
    "login.description": "أدخل بريدك الإلكتروني وكلمة المرور للوصول إلى لوحة التحكم",
    email: "البريد الإلكتروني",
    password: "كلمة المرور",
    "forgot.password": "نسيت كلمة المرور؟",
    "forgot.password.title": "نسيت كلمة المرور؟",
    "forgot.password.description": "أدخل بريدك الإلكتروني وسنرسل لك رابطًا لإعادة تعيين كلمة المرور",
    "send.reset.link": "إرسال رابط إعادة التعيين",
    "back.to.login": "العودة إلى تسجيل الدخول",
    "check.email": "تحقق من بريدك الإلكتروني",
    "check.email.description": "لقد أرسلنا لك رابط إعادة تعيين كلمة المرور. يرجى التحقق من بريدك الإلكتروني.",
    "welcome.back": "مرحباً بك مجدداً",
    "enter.credentials": "أدخل بياناتك للوصول إلى لوحة التحكم",
    "reset.password": "إعادة تعيين كلمة المرور",
    "reset.password.description": "أدخل كلمة المرور الجديدة لحسابك",

    // Dashboard
    dashboard: "لوحة التحكم",
    "news.management": "إدارة الأخبار",
    "events.management": "إدارة الفعاليات",
    "members.management": "إدارة الأعضاء",
    "user.management": "إدارة المستخدمين",
    profile: "الملف الشخصي",
    

    logout: "تسجيل الخروج",
    "switch.language": "تبديل اللغة",
    "add.member": "إضافة عضو",
    "system.settings": "إعدادات النظام",
    "dashboard.title": "لوحة التحكم | إدارة الرياضة",
    "dashboard.description": "نظرة عامة على لوحة تحكم إدارة الرياضة",
    "news.title": "إدارة الأخبار | إدارة الرياضة",
    "news.description": "إدارة المقالات الإخبارية للموقع الرياضي",
    "events.title": "إدارة الفعاليات | إدارة الرياضة",
    "events.description": "إدارة الفعاليات للموقع الرياضي",
    "users.title": "إدارة المستخدمين | إدارة الرياضة",
    "users.description": "إدارة مستخدمي النظام",
    "settings.title": "الإعدادات | إدارة الرياضة",
    "settings.description": "إعدادات النظام",
    "create.event.title": "إنشاء فعالية | إدارة الرياضة",
    "create.event.description": "إنشاء فعالية جديدة",
    "edit.event.title": "تعديل فعالية | إدارة الرياضة",
    "edit.event.description": "تعديل فعالية موجودة",
    "create.user.title": "إنشاء مستخدم | إدارة الرياضة",
    "create.user.description": "إنشاء مستخدم جديد",

    // Stats
    "total.news": "إجمالي الأخبار",
    "upcoming.events": "الفعاليات القادمة",
    "past.events": "الفعاليات السابقة",
    "active.users": "المستخدمين النشطين",
    "from.last.month": "من الشهر الماضي",
    "scheduled.this.week": "مجدولة هذا الأسبوع",
    "from.last.quarter": "من الربع الماضي",
    "since.last.login": "منذ آخر تسجيل دخول",
    members: "الاعضاء",
    "member.profile": "الملف الشخصي",
    // "confirm.delete.user.title":"حذف المستخدم",
    // "confirm.delete.user.description":"هل أنت متأكد من رغبتك في حذف   ذا المستخدم؟",
    // "confirm.delete.user.button":"حذف",
    // "confirm.delete.user.cancel":"إلغاء",
    "confirm.delete.member.title":"حذف العضو",
    "confirm.delete.member.description":"هل أنت متأكد من رغبتك في حذف هذا العضو؟",
    "confirm.delete.member.button":"حذف",
    "confirm.delete.member.cancel":"إلغاء",
    "other.language": "اللغة الأخرى",
    "member.not.found": "عضو غير موجود",
    "back.to.members": "العودة إلى قائمة الأعضاء",
    "edit.member": "تعديل العضو",
    "description": "الوصف",
    "position": "الموقع",
    "Image":"الصورة",

    // Content
    "content.overview": "نظرة عامة على المحتوى",
    "recent.news": "أحدث الأخبار",
    "recent.news.description": "آخر المقالات الإخبارية المنشورة",
    "upcoming.events.title": "الفعاليات القادمة",
    "upcoming.events.description": "الفعاليات المجدولة للثلاثين يومًا القادمة",

    // News
    "add.news": "إضافة خبر",
    "create.news": "إنشاء خبر جديد",
    "edit.news": "تعديل الخبر",
    "news.title.ar": "عنوان الخبر",
    "news.title.en": "العنوان (بالإنجليزية)",
    "news.title.ar.placeholder": "أدخل عنوان الخبر بالعربية",
    "news.title.en.placeholder": "أدخل عنوان الخبر بالإنجليزية",
    "news.content.ar": "المحتوى (بالعربية)",
    "news.content.en": "المحتوى (بالإنجليزية)",
    "news.content.ar.placeholder": "أدخل محتوى الخبر بالعربية",
    "news.content.en.placeholder": "أدخل محتوى الخبر بالإنجليزية",
    "confirm.delete.news.title":"حذف العضو",
    "confirm.delete.news.description":"هل أنت متأكد من رغبتك في حذف هذا العضو؟",
    "confirm.delete.news.button":"حذف",
    "confirm.delete.news.cancel":"إلغاء",

    content: "المحتوى",
    "publication.date": "تاريخ النشر",
    "select.date": "اختر التاريخ",
    image: "الصورة",
    "news.images": "صور الخبر (الحد الأقصى 3 صور)",
    "upload.image": "رفع صورة",
    "add.image": "إضافة صورة",
    "choose.image": "اختر صورة",
    "change.image": "تغيير الصورة",
    "no.image.uploaded": "لم يتم رفع صورة",
    "image.required": "يجب إضافة صورة واحدة على الأقل",
    "update.news": "تحديث الخبر",
    "update.news.success.title": "تم تحديث الخبر",
    "update.news.success.description": "تم تحديث الخبر بنجاح.",
    "create.news.success.title": "تم إنشاء الخبر",
    "create.news.success.description": "تم إنشاء الخبر بنجاح.",
    "news.save.error": "حدث خطأ أثناء حفظ الخبر",
    "news.category.placeholder": "اختر فئة الخبر",
    "loading.categories": "جاري تحميل الفئات...",
    "no.categories.available": "لا توجد فئات متاحة",
    "create.news.button": "إنشاء خبر جديد",
    "news.category": "تصنيف الخبر",
    "news.featured": "مميز",
    "news.language": "اللغة",
    "news.publish": "نشر",
    "news.unpublish": "إلغاء النشر",
    "news.delete": "حذف",
    "news.view": "عرض",
    "news.management.title": "إدارة الأخبار",
    "news.delete.success": "تم حذف المقال الإخباري بنجاح.",
    "news.delete.error": "فشل حذف المقال الإخباري. يرجى المحاولة مرة أخرى.",
    "open.menu": "فتح القائمة",
    "edit.news.title": "تعديل خبر | إدارة الرياضة",
    "edit.news.description": "تعديل مقال إخباري موجود",
    "news.not.found": "لم يتم العثور على المقال الإخباري",
    "news.not.found.error": "لم يتم العثور على المقال الإخباري. قد يكون تم حذفه أو تحريكه.",

    // Events
    "add.event": "إضافة فعالية",
    "create.event": "إنشاء فعالية جديدة",
    "edit.event": "تعديل الفعالية",
    "event.title": "عنوان الفعالية",
    "event.date": "تاريخ الفعالية",
    "event.time": "وقت الفعالية",
    "event.type": "نوع الفعالية",
    "event.category": "تصنيف الفعالية",
    "event.featured": "مميز",
    "event.language": "اللغة",
    "event.preview": "معاينة",
    "event.publish": "نشر",
    "event.unpublish": "إلغاء النشر",
    "event.delete": "حذف",
    "event.view": "عرض",
    "event.location": "الموقع",
    location: "الموقع",
    upcoming: "قادمة",
    past: "سابقة",
    "update.event": "تحديث الفعالية",
    "create.event.button": "إنشاء الفعالية",
    "events.management.title": "إدارة الفعاليات",
    "event.save.draft": "حفظ كمسودة",
    tournament: "بطولة",
    championship: "دوري",
    seminar: "ندوة",
    training: "تدريب",
    exhibition: "معرض",
    conference: "مؤتمر",
    other: "أخرى",

    // Users
    users: "المستخدمين",
    "add.user": "إضافة مستخدم",
    "create.user": "إنشاء مستخدم جديد",
    "edit.user": "تعديل المستخدم",
    name: "الاسم",
    role: "الدور",
    status: "الحالة",
    admin: "مدير",
    editor: "محرر",
    viewer: "مشاهد",
    active: "نشط",
    inactive: "غير نشط",
    "update.user": "تحديث المستخدم",
    "create.user.button": "إنشاء المستخدم",
    "user.management.title": "إدارة المستخدمين",
    "user.delete.success.title": "تم حذف المستخدم",
    "user.delete.success.description": "تم حذف المستخدم بنجاح.",
    "user.delete.error": "حدث خطأ أثناء حذف المستخدم. يرجى المحاولة مرة أخرى.",
    "user.fetch.error": "حدث خطأ أثناء جلب بيانات المستخدم. يرجى المحاولة مرة أخرى.",
    "users.load.error": "فشل في تحميل المستخدمين. يرجى المحاولة مرة أخرى لاحقًا.",
    "user.not.found": "لم يتم العثور على المستخدم",
    "user.not.found.error": "لم يتم العثور على المستخدم. قد يكون تم حذفه أو تحريكه.",
    "phone.number": "رقم الهاتف",
    "confirm.delete.user.title":"حذف العضو",
    "confirm.delete.user.description":"هل أنت متأكد من رغبتك في حذف هذا العضو؟",
    "confirm.delete.user.button":"حذف",
    "confirm.delete.user.cancel":"إلغاء",
    user: "المستخدم",
    "profile.image": "الصورة الشخصية",

    // Table
    actions: "الإجراءات",
    edit: "تعديل",
    delete: "حذف",
    previous: "السابق",
    next: "التالي",
    "no.news.found": "لم يتم العثور على أخبار",
    "no.events.found": "لم يتم العثور على فعاليات",
    "no.users.found": "لم يتم العثور على مستخدمين",

    // Profile
    "personal.information": "المعلومات الشخصية",
    "update.profile": "تحديث الملف الشخصي",
    "change.password": "تغيير كلمة المرور",
    "current.password": "كلمة المرور الحالية",
    "new.password": "كلمة المرور الجديدة",
    "confirm.password": "تأكيد كلمة المرور",
    "profile.picture": "الصورة الشخصية",
    "profile.not.found": "لم يتم العثور على الملف الشخصي",
    "profile.data.error": "حدث خطأ أثناء جلب بيانات الملف الشخصي",

    // Settings
    "general.settings": "الإعدادات العامة",
    language: "اللغة",
    arabic: "العربية",
    english: "الإنجليزية",
    notifications: "الإشعارات",
    "notifications.description": "إدارة إعدادات الإشعارات الخاصة بك",
    "email.notifications": "إشعارات البريد الإلكتروني",
    "email.notifications.description": "تلقي إشعارات عبر البريد الإلكتروني عند إضافة محتوى جديد أو تحديثه.",
    "push.notifications": "الإشعارات الفورية",
    "push.notifications.description": "تلقي إشعارات فورية عند إضافة محتوى جديد أو تحديثه.",

    // Months
    jan: "يناير",
    feb: "فبراير",
    mar: "مارس",
    apr: "أبريل",
    may: "مايو",
    jun: "يونيو",
    jul: "يوليو",
    aug: "أغسطس",
    sep: "سبتمبر",
    oct: "أكتوبر",
    nov: "نوفمبر",
    dec: "ديسمبر",

    // Footer
    copyright: "© {year} إدارة الرياضة. جميع الحقوق محفوظة.",
    
    // Platform
    "platform.description": "منصة متكاملة لإدارة الأنشطة الرياضية والفعاليات بكفاءة عالية",
    "platform.features": "مميزات النظام",
    "platform.easy.management": "إدارة سهلة",
    "platform.easy.management.description": "واجهة سهلة الاستخدام لإدارة جميع الأنشطة والفعاليات الرياضية",
    "platform.secure": "آمن وموثوق",
    "platform.secure.description": "حماية كاملة للبيانات والمعلومات الخاصة بك مع تشفير متقدم",
    "platform.analytics": "تحليلات متقدمة",
    "platform.analytics.description": "رؤى وتحليلات شاملة لمساعدتك على اتخاذ قرارات أفضل",

    // Misc
    by: "بواسطة",
    on: "في",
    "pick.a.date": "اختر تاريخًا",
    "select.event.type": "اختر نوع الفعالية",
    "enter.event.location": "أدخل موقع الفعالية",
    "select.option": "اختر خيارًا",
    "search.placeholder": "بحث...",
    "filter.by": "تصفية حسب",
    "sort.by": "ترتيب حسب",
    "items.per.page": "عناصر في الصفحة",
    showing: "عرض",
    of: "من",
    items: "عناصر",
    page: "صفحة",
    "first.page": "الصفحة الأولى",
    "last.page": "الصفحة الأخيرة",
    "go.to.page": "انتقل إلى الصفحة",
    "no.results": "لا توجد نتائج",
    loading: "جاري التحميل...",
    error: "خطأ",
    success: "نجاح",
    warning: "تحذير",
    info: "معلومات",
    confirm: "تأكيد",
    close: "إغلاق",
    save: "حفظ",
    add: "إضافة",
    remove: "إزالة",
    view: "عرض",
    download: "تنزيل",
    upload: "رفع",
    copy: "نسخ",
    paste: "لصق",
    cut: "قص",
    undo: "تراجع",
    redo: "إعادة",
    "select.all": "تحديد الكل",
    "select.none": "إلغاء التحديد",
    select: "تحديد",
    clear: "مسح",
    search: "بحث",
    filter: "تصفية",
    sort: "ترتيب",
    refresh: "تحديث",
    more: "المزيد",
    less: "أقل",
    "show.more": "عرض المزيد",
    "show.less": "عرض أقل",
    expand: "توسيع",
    collapse: "طي",
    details: "تفاصيل",
    summary: "ملخص",

    // UI Common
    cancel: "إلغاء",
    saving: "جاري الحفظ...",
    sending: "جاري الإرسال...",
    "logging.in": "جاري تسجيل الدخول...",
    required: "مطلوب",
    optional: "اختياري",
    preview: "معاينة",
  },
  en: {
    // Auth
    login: "Login",
    "login.title": "Login to your account",
    "login.description": "Enter your email and password to access the dashboard",
    email: "Email",
    password: "Password",
    "forgot.password": "Forgot your password?",
    "forgot.password.title": "Forgot your password?",
    "forgot.password.description": "Enter your email address and we'll send you a link to reset your password",
    "send.reset.link": "Send Reset Link",
    "back.to.login": "Back to login",
    "check.email": "Check your email",
    "check.email.description": "We've sent you a password reset link. Please check your email.",
    "welcome.back": "Welcome back",
    "enter.credentials": "Enter your credentials to access the dashboard",
    "reset.password": "Reset Password",
    "reset.password.description": "Enter a new password for your account",

    // Dashboard
    dashboard: "Dashboard",
    "news.management": "News Management",
    "events.management": "Events Management",
    "members.management": "Members Management",
    "user.management": "User Management",
    profile: "Profile",
    logout: "Log out",
    "switch.language": "Switch Language",
    "add.member": "Add Member",
    "system.settings": "System Settings",
    "dashboard.title": "Dashboard | Sports Management",
    "dashboard.description": "Overview of the sports management dashboard",
    "news.title": "News Management | Sports Management",
    "news.description": "Manage news articles for the sports website",
    "events.title": "Events Management | Sports Management",
    "events.description": "Manage events for the sports website",
    "users.title": "User Management | Sports Management",
    "users.description": "Manage system users",
    "settings.title": "Settings | Sports Management",
    "settings.description": "System settings",
    "create.event.title": "Create Event | Sports Management",
    "create.event.description": "Create a new event",
    "edit.event.title": "Edit Event | Sports Management",
    "edit.event.description": "Edit an existing event",
    "create.user.title": "Create User | Sports Management",
    "create.user.description": "Create a new user",

    // Stats
    "total.news": "Total News",
    "upcoming.events": "Upcoming Events",
    "past.events": "Past Events",
    "active.users": "Active Users",
    "from.last.month": "from last month",
    "scheduled.this.week": "scheduled this week",
    "from.last.quarter": "from last quarter",
    "since.last.login": "since last login",
    members: "Members",
    
    "member.profile": "Member Profile",
    "member.profile.title": "Board Member",
    "other.language": "Other Language",
    "member.not.found": "Member not found",
    "back.to.members": "Back to Members list",
    "confirm.delete.member.title": "Delete member",
    "confirm.delete.member.description": "Are you sure you want to delete this member article?",
    "confirm.delete.member.button": "Delete",
    "confirm.delete.member.cancel": "Cancel",
    "edit.member": "Edit Member",
    "description": "Description",
    "position": "Position",
"Image":"image",
    // Content
    "content.overview": "Content Overview",
    "recent.news": "Recent News",
    "recent.news.description": "Latest news articles published",
    "upcoming.events.title": "Upcoming Events",
    "upcoming.events.description": "Events scheduled for the next 30 days",

    // News
    "add.news": "Add News",
    "create.news": "Create News Article",
    "edit.news": "Edit News Article",
    "news.title.ar": "Title (Arabic)",
    "news.title.en": "Title (English)",
    "news.title.ar.placeholder": "Enter news title in Arabic",
    "news.title.en.placeholder": "Enter news title in English",
    "news.content.ar": "Content (Arabic)",
    "news.content.en": "Content (English)",
    "news.content.ar.placeholder": "Enter news content in Arabic",
    "news.content.en.placeholder": "Enter news content in English",
    content: "Content",
    "publication.date": "Publication Date",
    "select.date": "Select date",
    image: "Image",
    "news.images": "News Images (Max 3 images)",
    "upload.image": "Upload Image",
    "add.image": "Add Image",
    "choose.image": "Choose Image",
    "change.image": "Change Image",
    "no.image.uploaded": "No image uploaded",
    "image.required": "At least one image is required",
    "update.news": "Update News",
    "update.news.success.title": "News Updated",
    "update.news.success.description": "News article updated successfully.",
    "create.news.success.title": "News Created",
    "create.news.success.description": "News article created successfully.",
    "news.save.error": "Error occurred while saving the news",
    "news.category.placeholder": "Select news category",
    "loading.categories": "Loading categories...",
    "no.categories.available": "No categories available",
    "create.news.button": "Create News Article",
    "news.category": "Category",
    "news.featured": "Featured",
    "news.language": "Language",
    "news.publish": "Publish",
    "news.unpublish": "Unpublish",
    "news.delete": "Delete",
    "news.view": "View",
    "confirm.delete.news.title": "Delete News",
    "confirm.delete.news.description": "Are you sure you want to delete this news article?",
    "confirm.delete.news.button": "Delete",
    "confirm.delete.news.cancel": "Cancel",
    "news.management.title": "News Management",
    "news.delete.success": "News article deleted successfully.",
    "news.delete.error": "Failed to delete news article. Please try again.",
    "open.menu": "Open Menu",
    "edit.news.title": "Edit News | Sports Management",
    "edit.news.description": "Edit an existing news article",
    "news.not.found": "News article not found",
    "news.not.found.error": "News article not found. It may have been deleted or moved.",

    // Events
    "add.event": "Add Event",
    "create.event": "Create Event",
    "edit.event": "Edit Event",
    "event.title": "Title",
    "event.date": "Event Date",
    "event.time": "Event Time",
    "event.type": "Event Type",
    "event.category": "Category",
    "event.featured": "Featured",
    "event.language": "Language",
    "event.preview": "Preview",
    "event.publish": "Publish",
    "event.unpublish": "Unpublish",
    "event.delete": "Delete",
    "event.view": "View",
    "event.location": "Location",
    location: "Location",
    upcoming: "Upcoming",
    past: "Past",
    "update.event": "Update Event",
    "create.event.button": "Create Event",
    "events.management.title": "Events Management",
    "event.save.draft": "Save as Draft",
    tournament: "Tournament",
    championship: "Championship",
    seminar: "Seminar",
    training: "Training",
    exhibition: "Exhibition",
    conference: "Conference",
    other: "Other",

    // Users
    users: "Users",
    "add.user": "Add User",
    "create.user": "Create User",
    "edit.user": "Edit User",
    name: "Name",
    role: "Role",
    status: "Status",
    admin: "Admin",
    editor: "Editor",
    viewer: "Viewer",
    active: "Active",
    inactive: "Inactive",
    "update.user": "Update User",
    "create.user.button": "Create User",
    "user.management.title": "User Management",
    "user.delete.success.title": "User Deleted",
    "user.delete.success.description": "User has been deleted successfully.",
    "user.delete.error": "Failed to delete user. Please try again.",
    "user.fetch.error": "Failed to fetch user data. Please try again.",
    "users.load.error": "Failed to load users. Please try again later.",
    "user.not.found": "User not found",
    "user.not.found.error": "User not found. It may have been deleted or moved.",
    "phone.number": "Phone Number",
    user: "User",
    "profile.image": "Profile Image",
    "confirm.delete.user.title": "Delete User",
    "confirm.delete.user.description": "Are you sure you want to delete this user?",
    "confirm.delete.user.button": "Delete",
    "confirm.delete.user.cancel": "Cancel",
    // Table
    actions: "Actions",
    edit: "Edit",
    delete: "Delete",
    previous: "Previous",
    next: "Next",
    "no.news.found": "No news articles found.",
    "no.events.found": "No events found.",
    "no.users.found": "No users found.",

    // Profile
    "personal.information": "Personal Information",
    "update.profile": "Update Profile",
    "change.password": "Change Password",
    "current.password": "Current Password",
    "new.password": "New Password",
    "confirm.password": "Confirm Password",
    "profile.picture": "Profile Picture",
    "profile.not.found": "Profile not found",
    "profile.data.error": "Error loading profile data",

    // Settings
    "general.settings": "General Settings",
    language: "Language",
    arabic: "Arabic",
    english: "English",
    notifications: "Notifications",
    "notifications.description": "Manage your notification settings",
    "email.notifications": "Email Notifications",
    "email.notifications.description": "Receive notifications via email when new content is added or updated.",
    "push.notifications": "Push Notifications",
    "push.notifications.description": "Receive instant notifications when new content is added or updated.",

    // Months
    jan: "Jan",
    feb: "Feb",
    mar: "Mar",
    apr: "Apr",
    may: "May",
    jun: "Jun",
    jul: "Jul",
    aug: "Aug",
    sep: "Sep",
    oct: "Oct",
    nov: "Nov",
    dec: "Dec",

    // Footer
    copyright: "© {year} Sports Management. All rights reserved.",
    
    // Platform
    "platform.description": "An integrated platform for efficiently managing sports activities and events",
    "platform.features": "Platform Features",
    "platform.easy.management": "Easy Management",
    "platform.easy.management.description": "User-friendly interface for managing all sports activities and events",
    "platform.secure": "Secure and Reliable",
    "platform.secure.description": "Complete protection for your data and information with advanced encryption",
    "platform.analytics": "Advanced Analytics",
    "platform.analytics.description": "Comprehensive insights and analytics to help you make better decisions",

    // Misc
    by: "By",
    on: "on",
    "pick.a.date": "Pick a date",
    "select.event.type": "Select event type",
    "enter.event.location": "Enter event location",
    "select.option": "Select an option",
    "search.placeholder": "Search...",
    "filter.by": "Filter by",
    "sort.by": "Sort by",
    "items.per.page": "Items per page",
    showing: "Showing",
    of: "of",
    items: "items",
    page: "Page",
    "first.page": "First page",
    "last.page": "Last page",
    "go.to.page": "Go to page",
    "no.results": "No results",
    loading: "Loading...",
    error: "Error",
    success: "Success",
    warning: "Warning",
    info: "Info",
    confirm: "Confirm",
    close: "Close",
    save: "Save",
    add: "Add",
    remove: "Remove",
    view: "View",
    download: "Download",
    upload: "Upload",
    copy: "Copy",
    paste: "Paste",
    cut: "Cut",
    undo: "Undo",
    redo: "Redo",
    "select.all": "Select all",
    "select.none": "Select none",
    select: "Select",
    clear: "Clear",
    search: "Search",
    filter: "Filter",
    sort: "Sort",
    refresh: "Refresh",
    more: "More",
    less: "Less",
    "show.more": "Show more",
    "show.less": "Show less",
    expand: "Expand",
    collapse: "Collapse",
    details: "Details",
    summary: "Summary",

    // UI Common
    cancel: "Cancel",
    saving: "Saving...",
    sending: "Sending...",
    "logging.in": "Logging in...",
    required: "Required",
    optional: "Optional",
    preview: "Preview",
  },
}

const LanguageContext = createContext<LanguageContextType>({
  language: "ar",
  setLanguage: () => {},
  t: (key: string) => key,
  dir: "rtl",
  isLoaded: false
})

export function useLanguage() {
  return useContext(LanguageContext)
}

export function LanguageProvider({ children }: { children: React.ReactNode }) {
  const [isLoaded, setIsLoaded] = useState(false)
  const [language, setLanguage] = useState<Language>("ar")
  const dir = language === "ar" ? "rtl" : "ltr"

  // تنفيذ هذا الأثر عند تحميل المكون لأول مرة فقط
  useEffect(() => {
    try {
      // قراءة تفضيل اللغة من التخزين المحلي
      const savedLanguage = localStorage.getItem("uaemmaf-language") as Language | null
      
      if (savedLanguage && (savedLanguage === "ar" || savedLanguage === "en")) {
        setLanguage(savedLanguage)
      }
      
      // تحديث سمات HTML
      const htmlElement = document.documentElement
      htmlElement.lang = savedLanguage || language
      htmlElement.dir = (savedLanguage === "en") ? "ltr" : "rtl"
    } finally {
      // تعيين الحالة إلى محمّل بغض النظر عن نجاح القراءة من التخزين
      setIsLoaded(true)
    }
  }, [])

  // الاستجابة للتغييرات في اللغة
  useEffect(() => {
    if (!isLoaded) return

    const htmlElement = document.documentElement
    htmlElement.lang = language
    htmlElement.dir = language === "ar" ? "rtl" : "ltr"
  }, [language, isLoaded])

  const handleSetLanguage = (lang: Language) => {
    setLanguage(lang)
    localStorage.setItem("uaemmaf-language", lang)
  }

  const t = (key: string) => {
    // Type-safe translation lookup
    return (translations[language] as Record<string, string>)[key] || key;
  }

  return (
    <LanguageContext.Provider value={{ language, setLanguage: handleSetLanguage, t, dir, isLoaded }}>
      {children}
    </LanguageContext.Provider>
  )
}
